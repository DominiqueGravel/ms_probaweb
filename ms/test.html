<p><strong>Title:</strong> Bringing Elton and Grinnell together: a quantitative framework to represent the biogeography of ecological interaction networks<br />
</p>
<h1 id="abstract" class="unnumbered">Abstract</h1>
<p>Biogeography has traditionally focused on the spatial distribution and abundance of species. Both are driven by the way species interact with one another, but only recently community ecologists realized the need to document their spatial and temporal variation. Here, we call for an integrated approach, adopting the view that community structure is best represented as a network of ecological interactions, and show how it translates to biogeography questions. We propose that the ecological niche should encompass the effect of the environment on species distribution (the Grinnellian dimension of the niche) and on the ecological interactions among them (the Eltonian dimension). Starting from this concept, we develop a quantitative theory to explain turnover of interactions in space and time – <em>i.e.</em> a novel approach to interaction distribution modeling. We apply this framework to host–parasite interactions across Europe and find that two aspects of the environment (temperature and precipitation) exert a strong imprint on species co- occurrence, but not on species interactions. Even where species co-occur, interaction proves to be stochastic rather than deterministic, adding to variation in realized network structure. We also find that a large majority of host-parasite pairs are never found together, thus precluding any inferences regarding their probability to interact. This first attempt to explain variation of network structure at large spatial scales opens new perspectives at the interface of species distribution modeling and community ecology.</p>
<p><strong>Keywords:</strong> networks, spatial ecology, co-occurrence, probability of interaction<br />
</p>
<h1 id="introduction" class="unnumbered">Introduction</h1>
<p>Community ecology is <em>the study of the interactions that determine the distribution and abundance of organisms</em> <span class="citation"></span>. Despite a general consensus on this definition <span class="citation"></span>, research on variation in community structure (beta-diversity) has mostly focused on the spatial and temporal turnover of species composition <span class="citation"></span>. Such research usually neglects variation in the way species interact with each other, despite accumulating empirical evidence that is a major source of diversity <span class="citation"></span>. Given this omission, it is perhaps not surprising that biogeographers are still struggling to establish whether interactions actually impacts the distribution of species at large spatial scales <span class="citation"></span>. An interaction is conceived as the direct effect of the action of one species on the demography on another species; whether it scales up and impact the (co-)distribution of species remains matter of debate at the moment <span class="citation"></span>. Treating interactions as fixed events nonetheless neglects a large part of the complexity of empirical communities, and will most likely deliver biased metrics <span class="citation"></span>. Recent attempts at accounting for interactions in species distribution models <span class="citation"></span> have brought some methodological advances, but are not sufficient for two reasons. First, these techniques are still based on a ‘species-based’ approach to communities, where interactions are merely treated as fixed covariates affecting distribution. Second, they fail to provide a conceptual step forward, both in their treatment of interactions and in the quality of the predictions they make.</p>
<p>Network approaches offer a convenient representation of communities because they simultaneously account for species composition and their interactions. Species are represented as nodes, so that networks already encompass all the information used by current approaches of species distribution modeling; in addition, interactions are represented by links, so that networks provide additional information on community structure. To date, studies of network diversity have mostly been concerned with the distribution of interactions within locations, and less so with variation among locations <span class="citation"></span>. There is, however, ample evidence that interaction networks vary in space and time <span class="citation"></span>, even though there is no common framework with which to generalize these results. Metacommunity theory provides explanations for variation in the distribution of the nodes <span class="citation"></span>, but there are no such explanation to the variation of node and link occurrences. Consequently, we need theory to formalize these observations, as it is the only way towards fulfilling the goal of community ecology: providing cogent predictions about, and understanding of, the structure of ecological communities.</p>
<p>Given the historically different approaches to modelling the distributions of species vs. interactions, there is a need to bring the two together. Here, we offer an integrated approach to do so, adopting the view that community structure is best represented as a network of ecological interactions. Based on this idea, we propose a description of the ecological niche that integrates the effect of the environment on species distribution and on the ecological interactions among them. Building on this concept, we develop a quantitative theory to explain turnover of interactions in space and time. We first present the concept and then formalize it mathematically, using a probabilistic model to represent the sampling of the regional pool of interactions. At the level of species pairs, the statistical approach could be conceived as an interaction distribution model. At the community level, the approach provides a likelihood-based method to compare different hypotheses of network turnover. As an illustrative example, we apply this novel framework to a large data set on host-parasite interactions across Europe and find that two aspects of the environment (temperature and precipitation) exert a strong imprint on species co-occurrence, but not on species interactions. The network structure changes systematically across the latitudinal gradient, with a peak of connectance at intermediate latitudes.</p>
<h1 id="the-two-dimensions-of-community-structure" class="unnumbered">The two dimensions of community structure</h1>
<p>The problem of community assembly is often formulated as <em>how are species sampled from a regional pool to constitute a local community</em> <span class="citation"></span>? This question could be rewritten to address the problem of network assembly, as <em>how do samples from a regional pool of interactions constitute a local interaction network?</em> An illustration of this problem for a food web is provided in Fig. 1. The regional pool of interactions, the <em>metaweb</em>, represents potential interactions among all species that could be found in a given area. In this particular case, there are 275 nodes, and 1173 links among the plants (52 nodes), herbivores (96 nodes), and parasitoids (127 nodes) from Northern Europe. An instance of a local community is also illustrated, with 45 nodes and 93 interactions. Only 55.0% of all potential interactions (plant-herbivore or herbivore parasitoid combinations) are realized in this local network, revealing the stochastic nature of ecological interactions. Our objective here is to provide theory to explain the sampling of the regional pool of interactions, along with a quantitative method to predict it. The problem could be formalized sequentially by understanding first why only a fraction of the species co-occur locally and second why these species do or do not interact.</p>
<p>There are multiple causes of spatial turnover of species co-occurrence. The first and most-studied driver is the effect of variation in the abiotic environment on species performance. Combined with specific responses in demography, it generates variation among sites by selecting the locally fittest species <span class="citation"></span>. Stochasticity plays an additional role, either because colonization and extinction events <span class="citation"></span> are inherently unpredictable or because strong non-linear feedbacks in community dynamics generate alternative transients and equilibria <span class="citation"></span>. Interaction themselves may impact co-distribution, as hypothesized long ago by <span class="citation"></span>. Analyses of community turnover are usually performed with data represented in a table with rows corresponding to sites (or measurements) and columns to species. Metrics of beta diversity quantify the variance of this community data <span class="citation"></span>. Traditional approaches rely on measures of dissimilarity among communities, such as the Jaccard or Bray–Curtis indices. More recent approaches decompose total variation of the community data into species and site contributions to beta diversity <span class="citation"></span>, and further partition it into dissimilarity due to changes in species richness and dissimilarity due to actual species turnover <span class="citation"></span>. Even though all of these methods compare whole lists of species among sites or measurements, they remain fundamentally “species-based”, since they report variation within columns. None of them explicitly considers variation of associations (i.e., of pairs or higher-order motifs – <span class="citation"></span>). Some previous studies have considered how species distribution could be influenced by the joint effects of the abiotic and biotic environment <span class="citation"></span>, here we inverse the problem and describe how the distribution of biotic interactions is influenced by species distribution and the environment.</p>
<p>We are now getting a better understanding of interaction turnover. As mentioned above, in the network approach to community structure, species and interactions are represented by nodes and links, respectively. Associations can also be represented by matrices in which entries represent the occurrence or intensity of interactions among species (rows and columns). Network complexity is then computed as the number of interactions (in the case of binary networks) or interaction diversity (in the case of quantitative networks, <span class="citation"></span>). Variability in community structure consequently arises from the turnover of species composition, along with turnover of interactions among pairs of species. The occurrence and intensity of interactions could vary because of the environment, species abundance, and higher-order ecological interactions <span class="citation"></span>. Variation in community composition can be independent of variation of ecological interactions, suggesting that species and interaction distribution may well respond to different drivers <span class="citation"></span>.</p>
<p>The “niche” is by far the dominant concept invoked to explain species distributions and community assembly, from the local to the global scale. Following <span class="citation"></span>, the niche is viewed as the set of environmental conditions allowing a population to establish and persist (see also <span class="citation"></span>). In other words, the niche is the location in that multidimensional space allowing a species to have a positive growth rate when rare <span class="citation"></span>. Community turnover arises as a result of successive replacement of species along an environmental gradient, in agreement with the Gleasonian view of communities <span class="citation"></span>. The concept is straightforward to put into practice with species distribution models, as it maps naturally on available distributional and environmental data. Consequently, a vast array of statistical tools have been developed to implement it (e.g. BIOMOD <span class="citation"></span>, MaxEnt <span class="citation"></span>). It is however much harder to account for ecological interactions within this approach <span class="citation"></span>. As such, these interactions are often viewed as externalities constraining or expanding the range of environmental conditions required for a species to maintain a viable population <span class="citation"></span>.</p>
<p>Interestingly, the food web literature also has its own “niche model” to position a species in a community <span class="citation"></span>, generalized later to other types of interaction networks <span class="citation"></span>. The niche of a species in this context represents the multidimensional space of all of its interactions. Each species is characterized by a niche position, an optimum and a range over three to five different niche axes <span class="citation"></span>. The niche model of food web structure and its variants have successfully explained the complexity of a variety of networks, from food webs to plant-pollinator systems <span class="citation"></span>. This conceptual framework is, however, limited to local communities, and does not provide any explanation for the turnover of network structure along environmental gradients.</p>
<h1 id="the-integrated-niche" class="unnumbered">The integrated niche</h1>
<p>Despite several attempts to update the concept of the ecological niche, ecologists have not moved far beyond the “n-dimensional hypervolume” defined by <span class="citation"></span>. Despite its intuitive interpretation and easy translation into species distribution models <span class="citation"></span>, the concept has been frequently criticized <span class="citation"></span>, and several attempts have been made to expand and improve it <span class="citation"></span>.</p>
<p>Part of the problem surrounding the niche concept has been clarified with the distinction between Eltonian and Grinnellian definitions <span class="citation"></span>. The Grinnellian dimension of the niche is the set of abiotic environmental conditions required for a species to maintain a population in a location. The Grinnellian niche is intuitive to apply, and constitutes the conceptual backbone of species distribution models. The Eltonian niche, on the other hand, is ’the place of a species in its biotic environment, its relations to food and enemies’. While this aspect of the niche is well known by community ecologists, it is trickier to turn into predictive models. Nonetheless, the development of the niche model of food web structure <span class="citation"></span> and its parameterization using functional traits <span class="citation"></span> made it more operational.</p>
<p>These perspectives are rather orthogonal to each other, and this has resulted in considerable confusion in the literature <span class="citation"></span>. <span class="citation"></span> attempted to reconcile with the following definition: <em>“[The niche is] the joint description of the environmental conditions that allow a species to satisfy its minimum requirements so that the birth rate of a local population is equal to or greater than its death rate along with the set of per capita effects of that species on these environmental conditions”</em>. Their representation merges zero-net-growth isoclines delimiting the Grinnellian niche (“when does the population persist?”) with impact vectors delimiting the Eltonian niche (“what is the per-capita impact?”). While this representation has been very influential in local-scale community ecology (the resource-ratio theory of coexistence, <span class="citation"></span>), it remains impractical at larger spatial scales because of the difficulties in measuring it. The absence of any mathematical representation of the niche that can be easily fit to ecological data may explain why biogeographers are still struggling to develop species distribution models that also consider ecological interactions. Thus, a more integrative description of the niche will be key to understand spatial and temporal turnover in community structure.</p>
<p>We propose to integrate the two perspectives of the niche using a visual representation of both components (Fig. 2). The underlying rationale is that, in addition to the environmental constraints on demographic performance (Fig. 2, top panel), any organism requires resources to meet its metabolic demands and to sustain reproduction (Fig. 2, nodes in network of bottom panel). Abiotic environmental axes are any non-consumable factors affecting the demographic performance of an organism. Alternatively, the resource axes are traits of the resources that allow interactions with the consumers. By definition of what an interaction is, these axes also influence the growth rate. The niche can therefore be viewed as the set of abiotic environmental conditions (the Grinnellian component) along with the set of traits (the Eltonian component) that allow a population to establish and to grow at a location. This visual representation make operational the theoretical interpretation of the niche and species ranges by <span class="citation"></span>. Accordingly, each species can be characterized by an optimal position along both the environmental (x-axis) and the trait (y-axis) plane. The integrated niche is then the hypervolume where interactions can occur and where a population has a positive growth rate.</p>
<p>This approach changes the representation of the niche, putting species distributions and ecological interactions into the same formalism. Moreover, it allows the limits of the niche axes to be independent of each other (as in the example in Fig. 2), or to interact. Some of these axes may not be independent. For instance, the optimal prey size for predatory fishes could decline with increasing temperature <span class="citation"></span>, which would make diet boundaries functions of the environment. Alternatively, we could also consider that the growth rate of the predator changes with the size of its prey items, thereby altering the environmental boundaries and changing the shape of the niche in the middle of this visual representation. It is also important that this conceptual representation depicts a reality that could be highly dimensional and sometimes difficult to represent statistically <span class="citation"></span>.</p>
<h1 id="a-probabilistic-representation-of-interaction-networks-in-space" class="unnumbered">A probabilistic representation of interaction networks in space</h1>
<p>We now formalize the integrated niche with a probabilistic approach to interactions and distributions. In particular, we seek to represent the probability that an interaction between species <span class="math inline"><em>i</em></span> and <span class="math inline"><em>j</em></span> occurs at location <span class="math inline"><em>y</em></span>. We define <span class="math inline"><em>L</em><sub><em>i</em><em>j</em><em>y</em></sub></span> as a stochastic process taking a value of 1 when an interaction occurs and a value of 0 when it does not, and focus on the probability that this event occurs, <span class="math inline"><em>P</em>(<em>L</em><sub><em>i</em><em>j</em><em>y</em></sub> = 1)</span>, over a given sampling interval and space. We note that the occurrence of an interaction is dependent on the co-occurrence of species <span class="math inline"><em>i</em></span> and <span class="math inline"><em>j</em></span>. This argument might seem trivial at first, but the explicit consideration of this condition in the probabilistic representation of ecological interactions will prove instrumental to understanding their variation. We note this phenomenon we aim to describe differs fundamentally from the effect that interactions do have on co-occurrence <span class="citation"></span>. We similarly define <span class="math inline"><em>X</em><sub><em>i</em><em>y</em></sub></span> as a stochastic process representing the occurrence of species <span class="math inline"><em>i</em></span> at location <span class="math inline"><em>y</em></span>, taking a value of 1 when the species occurs and a value of 0 when it is absent. The quantity we seek to understand is the probability of a joint event, conditional on the set of environmental conditions <span class="math inline"><em>E</em><sub><em>y</em></sub></span>:</p>
<p><br /><span class="math display">P(<em>X</em><sub><em>i</em><em>y</em></sub>, <em>X</em><sub><em>j</em><em>y</em></sub>, <em>L</em><sub><em>i</em><em>j</em><em>y</em></sub>|<em>E</em><sub><em>y</em></sub>)</span><br /></p>
<p>Or simply said, the probability of observing both species <span class="math inline"><em>i</em></span> and <span class="math inline"><em>j</em></span> plus an interaction between <span class="math inline"><em>i</em></span> and <span class="math inline"><em>j</em></span> given the conditions <span class="math inline"><em>E</em><sub><em>y</em></sub></span> at location <span class="math inline"><em>y</em></span>. This probability could be decomposed into two parts using the product rule of probabilities:</p>
<p><br /><span class="math display"><em>P</em>(<em>X</em><sub><em>i</em><em>y</em></sub>, <em>X</em><sub><em>j</em><em>y</em></sub>, <em>L</em><sub><em>i</em><em>j</em><em>y</em></sub>|<em>E</em><sub><em>y</em></sub>)=<em>P</em>(<em>X</em><sub><em>i</em><em>y</em></sub>, <em>X</em><sub><em>j</em><em>y</em></sub>|<em>E</em><sub><em>y</em></sub>)<em>P</em>(<em>L</em><sub><em>i</em><em>j</em><em>y</em></sub>|<em>X</em><sub><em>i</em><em>y</em></sub>, <em>X</em><sub><em>j</em><em>y</em></sub>, <em>E</em><sub><em>y</em></sub>)</span><br /></p>
<p>The first term on the right-hand side of the equation is the probability of observing the two species co-occurring at location <span class="math inline"><em>y</em></span>. It corresponds to the Grinnellian dimension of the niche. The second term represents the probability that an interaction occurs between species <span class="math inline"><em>i</em></span> and <span class="math inline"><em>j</em></span>, given that they are co-occurring. This predicate can be refined using information on trait distribution and trait matching rules . For brevity, we have here avoided specific references to traits and considered that the interactions are provided in the data. But one could develop the model further to integrate such traits, inspired by the framework developed by Gravel et al. 2016. They proposed to represent the occurence of an interaction between species as a joint probability event <span class="math inline"><em>P</em>(<em>L</em><sub><em>i</em><em>j</em></sub>, <strong>T</strong><sub><em>i</em></sub>, <strong>T</strong><sub><em>j</em></sub>|<em>E</em>)</span>, where <span class="math inline"><strong>T</strong><sub><em>i</em></sub></span> and <span class="math inline"><strong>T</strong><sub><em>j</em></sub></span> are trait vectors for species <span class="math inline"><em>i</em></span> and <span class="math inline"><em>j</em></span> respectively. In order to develop a trait-based representation of the spatial variation of interactions, one may thereafter consider how these traits are related to the environment and how they co-occur. Above, we referred to this entity as the “metaweb” and note that it corresponds to the Eltonian dimension of the niche. Below, we will see how this formalism can be directly fit to empirical data, restricting ourselves to occurrences only and refering to the above citations for trait-matching and trait-environment relationships. But before turning to an application, we will discuss the interpretation of different variants of these two terms.</p>
<h2 id="variants-of-co-occurrence" class="unnumbered">Variants of co-occurrence</h2>
<p>There are several variants to the co-occurrence probability, representing different hypotheses concerning spatial variation in network structure (see the explicit formulations in Table 1). The simplest model relates the probability of co-occurrence directly to the environment, <span class="math inline"><em>P</em>(<em>X</em><sub><em>i</em><em>y</em></sub>, <em>X</em><sub><em>j</em><em>y</em></sub>|<em>E</em><sub><em>y</em></sub>)</span>. In this situation, there are no underlying assumptions about the ecological processes responsible for co-occurrence. Spatial associations between species could arise because interactions constrain distribution, where in such case the co-occurrence would be conditional on <span class="math inline"><em>L</em></span>, or, alternatively, because of environmental requirements shared between <span class="math inline"><em>i</em></span> and <span class="math inline"><em>j</em></span> <span class="citation"></span>. In the former case, species are not independent of each other and the conditional occurrence must be accounted for explicitly, <span class="math inline"><em>P</em>(<em>X</em><sub><em>i</em><em>y</em></sub>, <em>X</em><sub><em>j</em><em>y</em></sub>|<em>E</em><sub><em>y</em></sub>)=<em>P</em>(<em>X</em><sub><em>i</em><em>y</em></sub>|<em>E</em><sub><em>y</em></sub>, <em>X</em><sub><em>j</em><em>y</em></sub>)<em>P</em>(<em>X</em><sub><em>j</em><em>y</em></sub>|<em>E</em><sub><em>y</em></sub>)</span>. In the latter case, species are independent, and only the marginal occurrence must be accounted for, <span class="math inline"><em>P</em>(<em>X</em><sub><em>i</em><em>j</em><em>y</em></sub>|<em>E</em><sub><em>y</em></sub>)=<em>P</em>(<em>X</em><sub><em>i</em><em>y</em></sub>|<em>E</em><sub><em>y</em></sub>)<em>P</em>(<em>X</em><sub><em>j</em><em>y</em></sub>|<em>E</em><sub><em>y</em></sub>)</span>.</p>
<p>The co-occurrence probability itself could depend on ecological interactions. This should be viewed as the realized component of the niche (i.e. the distribution when accounting for species interactions). Direct pairwise interactions such as competition, facilitation, and predation have long been studied for their impact on co-distribution (e.g. <span class="citation"></span>). Second- and higher-order interactions (e.g. trophic cascades) could also affect co-occurrence <span class="citation"></span>. Co-occurrence of multiple species embedded in ecological networks is a topic of its own, however, and is influenced by both network topology and species richness <span class="citation"></span>. Not only direct interactions influence co-occurrence, but indirect interactions do as well (e.g. plant species sharing an herbivore, or herbivores sharing parasitoids, could repel each other in space <span class="citation"></span>). The impact of direct interactions and first-order indirect interactions on co-occurrence tends to vanish with increasing species richness in the community <span class="citation"></span>. Further, co-occurrence is also influenced by the covariance of interacting species to an environmental gradient <span class="citation"></span>.</p>
<p>The interpretation that interactions may impact co-occurrence, and that the realization of an interaction requires co-occurrence are not mutually exclusive. But since here the object is to describe the variation in the occurrence of interactions, which absolutely requires co-occurrence, we will give attention to this part of the problem. Relating co-occurrence to the structure of interaction networks is a problem on its own (and vice-versa). We will therefore focus here on the variation of interactions and not on their distribution, and leave this specific issue for the Perspectives section and future research.</p>
<h2 id="variants-of-the-metaweb" class="unnumbered">Variants of the metaweb</h2>
<p>There are also variants of the metaweb. First, most documented metawebs have thus far considered ecological interactions to be deterministic, rather than probabilistic (e.g. <span class="citation"></span>). Species are assumed to interact whenever they are found together in a location, independent of their local abundance and the local environment. In other words, <span class="math inline"><em>P</em>(<em>L</em><sub><em>i</em><em>j</em><em>y</em></sub>|<em>X</em><sub><em>i</em><em>y</em></sub> = 1, <em>X</em><sub><em>j</em><em>y</em></sub> = 1)=1</span>. This approach might be a reasonable approximation if the spatial or temporal scale of sampling and inference is so large that the probability of observing at least one interaction converges to unity. In this scenario, network variation arises solely from species distributions.</p>
<p>Second, ecological interactions could also vary with the environment, so that <span class="math inline"><em>P</em>(<em>L</em><sub><em>i</em><em>j</em><em>y</em></sub>|<em>E</em><sub><em>y</em></sub>)</span>. Although it is rare to see a conditional representation of pairwise ecological interactions, experimental studies have frequently revealed interactions to be sensitive to the environment. For instance, <span class="citation"></span> showed that predation risks of shorebirds vary at the continental scale, decreasing from the south to the north. It is also common to see increasing top-down control with temperature (e.g. <span class="citation"></span>). Effects of the environment on interactions <span class="citation"></span> also propagate up the community and influence network structure <span class="citation"></span>.</p>
<h1 id="application-continental-scale-variation-of-host-parasite-community-structure" class="unnumbered">Application: continental-scale variation of host-parasite community structure</h1>
<p>We now turn to an illustration of our theory with the analysis of an empirical dataset of host-parasite networks sampled throughout the south-north environmental gradient in continental Europe <span class="citation"></span>. Our objective here is to illustrate potential applications of the approach outlined above, rather than to specifically describe the biogeography of this particular community. The focal system consists of local food webs of willows (genus <em>Salix</em>), their galling insects, and the natural enemies (parasitoids and inquilines) of gallers. We ask: i) how much does network structure vary across the gradient, and ii) what is the primary driver of network turnover across the gradient?</p>
<h2 id="data" class="unnumbered">Data</h2>
<p>Communities of willows, gallers, and parasitoids are species-rich and widely distributed, with pronounced variation in community composition across space. The genus <em>Salix</em> includes over 400 species, most of which are shrubs or small trees <span class="citation"></span>, and is common in moist habitats across the Northern Hemisphere <span class="citation"></span>. Willows support a highly diverse community of herbivorous insects, with one of the main herbivore groups being gall-inducing sawflies (Hymenoptera: Tenthredinidae: Nematinae: Euurina <span class="citation"></span>. Gall formation is induced by sawfly females during oviposition, and includes marked manipulation of host-plant chemistry by the galler <span class="citation"></span>. The enemy community of the gallers includes nearly 100 species belonging to 17 insect families of four orders <span class="citation"></span>. These encompass two main types: inquiline larvae (Coleoptera, Lepidoptera, Diptera, and Hymenoptera) feed primarily on gall tissue, but typically kill the galler larva in the process, while parasitoid larvae (representing many families in Hymenoptera) kill the galler larvae by direct feeding <span class="citation"></span>.</p>
<p>Local realizations of the willow-galler-parasitoid network were reconstructed from community samples collected between 1982 and 2010. During this period, willow galls were collected at 370 sites across Central and Northern Europe. In total, 52, 96 and 127 <em>Salix</em>, galler and parasitoid and inquiline taxa were distinguished, respectively. The strength of this dataset is that observations were observed in situ, rather than inferred from expert knowledge or other sources of information, thereby allowing the analysis of their spatial variation. The drawback is that, because many species are rare, some of the pairs of species may have been observed co-occurring only a few times, or never. As a consequence, despite the extent of the sampling, there is significant uncertainty in the quantification of some of the links. The above described methodology explicitly aims at describing this uncertainty, and research should be done to develop methods to reduce it (see Conclusion).</p>
<p>The current study represents the first analysis of the full data set from a spatial perspective. Full details about data collection and species identification are provided in <span class="citation"></span>. Annual mean temperature and precipitation were obtained from WorldClim using the R package dismo <span class="citation"></span> and GPS coordinates of the sampling locations. While other covariates could have also been considered to represent the high dimensionality of the niche, these two variables are likely representative of the most important axes of European climate, and are also more easily interpretable than reduced variables obtained, for example, by principal component analysis.</p>
<h2 id="analysis" class="unnumbered">Analysis</h2>
<p>Computing the probability of observing an interaction involves fitting a set of binomial models and collecting their estimated probabilities. For the sake of illustration, we considered generalized linear models – although more flexible fitting algorithms (e.g. GAM or Random Forest) could equally well be used, as long as the algorithm can estimate the probability for each observation. The data consist of a simple (albeit large and sparse) table with the observation of each species, <span class="math inline"><em>X</em><sub><em>i</em><em>y</em></sub></span> and <span class="math inline"><em>X</em><sub><em>j</em><em>y</em></sub></span>, their co-occurrence, <span class="math inline"><em>X</em><sub><em>i</em><em>j</em><em>y</em></sub></span>, the observation of an interaction <span class="math inline"><em>L</em><sub><em>i</em><em>j</em><em>y</em></sub></span>, and environmental co- variates <span class="math inline"><em>E</em><sub><em>y</em></sub></span>. Thus, there is one row per pair of species per site. We considered that an absence of a record of an interaction between co-occurring species at a site means a true absence (see below for a discussion on this issue).</p>
<p>We compared three models for the co-occurrence probability. The first one directly represents the co-occurrence probability conditional on the local environment, <span class="math inline"><em>P</em>(<em>X</em><sub><em>i</em><em>y</em></sub>, <em>X</em><sub><em>j</em><em>y</em></sub>|<em>E</em><sub><em>y</em></sub>)</span> (models are listed in Tables 1 and 2). Hence, this model makes no assumption about the mechanisms driving co- occurrence for any given environment, and instead uses the information directly available in the data. It thereby indirectly accounts for the effect of interactions on co-occurrence, if there are any. The second model considers independent occurrence of species. In this case, we independently fit <span class="math inline"><em>P</em>(<em>X</em><sub><em>i</em><em>y</em></sub>|<em>E</em><sub><em>y</em></sub>)</span> and <span class="math inline"><em>P</em>(<em>X</em><sub><em>j</em><em>y</em></sub>|<em>E</em><sub><em>y</em></sub>)</span>, and we then take their product to derive the probability of co-occurrence. This model should be viewed as a null hypothesis with respect to the first model, since a comparison between the respective models will reveal if there is significant spatial association of the two species beyond a joint response to the shared environment <span class="citation"></span>. Finally, the third model assumes that the probability of co-occurrence is independent of the environment and thus constant throughout the landscape. In other words, <span class="math inline"><em>P</em>(<em>X</em><sub><em>i</em><em>y</em></sub>, <em>X</em><sub><em>j</em><em>y</em></sub>)</span> is obtained by simply counting the number of observed co-occurrences divided by the total number of observations. Thus, the comparison between the first and third model allows us to test the hypothesis that co-occurrence is conditional on the environment. Whenever the environment was included as a covariate in the GLM, we considered a second-order polynomial term for both temperature and precipitation in order to account for optima in environmental conditions. There are consequently five parameters for the first model when fitting a given pair of species, 10 parameters for the second, and only one for the third model.</p>
<p>Following the same logic, we compared three models of the interaction probability. The first model conditions the interaction probability on the local environmental variables, <span class="math inline"><em>P</em>(<em>L</em><sub><em>i</em><em>j</em><em>y</em></sub>|<em>X</em><sub><em>i</em><em>y</em></sub>, <em>X</em><sub><em>j</em><em>y</em></sub>, <em>E</em><sub><em>y</em></sub>)</span>. Consequently, the model was fit to the subset of the data where the two species co-occur. The second model fits the interaction probability independently of the local environmental variables, <span class="math inline"><em>P</em>(<em>L</em><sub><em>i</em><em>j</em><em>y</em></sub>|<em>X</em><sub><em>i</em><em>y</em></sub>, <em>X</em><sub><em>j</em><em>y</em></sub>)</span>. It corresponds to the number of times the two species were observed to interact when co-occurring, divided by the number of times that they co-occurred. The third model is an extreme case evaluated only to test the hypothesis that if two species are found to interact at least once, then they should interact whenever they co-occur, <span class="math inline"><em>P</em>(<em>L</em><sub><em>i</em><em>j</em><em>y</em></sub>|<em>X</em><sub><em>i</em><em>y</em></sub>, <em>X</em><sub><em>j</em><em>y</em></sub>)=1</span>. While not necessarily realistic, this model tests an assumption commonly invoked in the representation of local networks from the knowledge of a deterministic metaweb. It represents potential interactions, rather than realized ones. There are consequently five parameters for the first model, a single parameter for the second model and no parameter to evaluate for the third model (where the interaction probability is fixed by the hypothesis).</p>
<p>We fitted the different models to each pair of species and recorded the predicted probabilities. The joint probability <span class="math inline"><em>P</em>(<em>L</em><sub><em>i</em><em>j</em><em>y</em></sub>, <em>X</em><sub><em>i</em><em>y</em></sub>, <em>X</em><sub><em>j</em><em>y</em></sub>)</span> was then computed from Eq. 2, and the likelihood of each observation <span class="math inline"><em>D</em><sub><em>i</em><em>j</em><em>y</em></sub></span> given the model <span class="math inline"><em>θ</em></span> was computed as <span class="math inline">ℒ(<em>D</em><sub><em>i</em><em>j</em><em>y</em></sub>|<em>θ</em>)=<em>P</em>(<em>L</em><sub><em>i</em><em>j</em></sub>, <em>X</em><sub><em>i</em><em>y</em></sub>, <em>X</em><sub><em>j</em><em>y</em></sub>)</span> if an interaction was observed, and as <span class="math inline">ℒ(<em>D</em><sub><em>i</em><em>j</em><em>y</em></sub>|<em>θ</em>)=1 − <em>P</em>(<em>L</em><sub><em>i</em><em>j</em><em>y</em></sub>, <em>X</em><sub><em>i</em><em>y</em></sub>, <em>X</em><sub><em>j</em><em>y</em></sub>)</span> if no interaction was observed. The log-likelihood was summed over the entire dataset to compare the different models by AIC. We therefore evaluate the likelihood of all local networks, given the model. Not surprisingly, there was a very large number of species pairs for which this model could not be computed, as they simply never co-occurred. For these pairs, we have no information of the interaction probability, and they were consequently removed from the analysis. The log-likelihood reported across the entire dataset was therefore summed over all pairs of species observed to co-occur at least once. Interactions between the first (<em>Salix</em>) and second (gallers) trophic layers and those between the second and third (parasitoids) were considered separately. Finally, we used the full model (in which both co-occurrence and the interaction are conditional on the environment) to interpolate species distributions and interaction probabilities across the entire European continent. We reconstructed the expected network for each location in a 1 X 1 km grid and computed the probabilistic connectance following <span class="citation"></span>.</p>
<p>All of the data are openly available in the database <em>mangal</em> <span class="citation"></span> and all R scripts for running the analyses, are provided in the github repository <a href="https://github.com/DominiqueGravel/ms_probaweb" class="uri">https://github.com/DominiqueGravel/ms_probaweb</a>.</p>
<h2 id="results" class="unnumbered">Results</h2>
<p>Despite the extensive sampling, many pairs of species were observed to co- occur only a few times. This made it difficult to evaluate interaction probabilities with any reasonable confidence. Thus, we start with an example of a single pair of species selected because of its high number of co- occurrences (<span class="math inline"><em>N</em><sub><em>i</em><em>j</em></sub> = 38</span>): the leaf folder <em>Phyllocolpa prussica</em> and the parasidoid <em>Chrysocharis elongata</em>. These two fairly abundant species were observed <span class="math inline"><em>N</em><sub><em>i</em></sub> = 49</span> and <span class="math inline"><em>N</em><sub><em>j</em></sub> = 121</span> times, respectively, across the 370 sites, and they were found to interact with a marginal probability <span class="math inline"><em>P</em>(<em>L</em><sub><em>i</em><em>j</em></sub>)=0.55</span>, which means they interacted at 21 different locations. Here, a comparison of model fit (Table 2) reveals that conditioning the interaction probability on local environmental conditions adds no explanatory power beyond a model assuming the same probability of interaction anywhere in space (Model 2 vs Model 3). Moreover, when the two species co-occur, the occurrence of the interaction was insensitive to the environment (Model 2 vs Model 3). Alternatively, climatic variables significantly impacted co-occurrence (Model 3 vs Model 4). The independent model performed worse than the non-random co- occurrence model (Model 3 vs Model 6). The full model revealed that the greatest interaction probability occurred at intermediate temperature and precipitation, simply because this is where the two species most frequently co-occur (Fig. 3). The probabilities of co-occurrence and interaction can be represented in space, where we find that the highest interaction probability occurred in Central Europe (Fig. 4).</p>
<p>We evaluated each model for all pairs of species in order to better understand the large-scale drivers of network turnover. The results were highly consistent among trophic levels (<em>Salix</em>-gallers and gallers-parasitoids; Table 3), despite large variability in the fit of the models to the different pairs of species. This variability was particularly important for the models of interactions given co-occurrence. Across all pairs of species, the conditional representation of interactions performed (Model 2) better than the marginal one (Model 1); that is, interactions did not occur systematically whenever the two species were found co-occurring. Hence, in addition to species turnover, the stochastic nature of interactions contributes to network variability. In total, we recorded 1,173 pairs of interactions, only 290 of which occurred more than five times. Out of these 290 interactions, 143 were systematically detected whenever the two species co-occurred. In the instances when species co-occurred, the two environmental variables considered proved relatively poor predictors of their interactions (Model 2 vs Model 3). Not surprisingly, for both types of interactions (<em>Salix</em>-galler and galler-parasitoid), the log-likelihood increased when the environment was considered. However, the extra number of parameters exceeded the gain in log-likelihood and inflated AIC. Therefore, the most parsimonious model excluded the effect of the environment. On the basis of log-likelihood only, co-occurrence was non-independent for both <em>Salix</em>-galler and galler-parasitoid interactions. Thus, according to AIC, the best model was the one of non-random co-occurrence (Model 3 vs Model 6) for both types of interactions.</p>
<p>Once we had selected the best model based on AIC (Model 3, Table 2), we used it to reconstruct the expected species richness, along with the most likely network for each location. Using this approach, we mapped the expected distribution of network properties across Europe (Fig. 5). For simplicity, we chose to consider connectance as our descriptor of network configuration, as this metric can be easily computed from probabilistic networks <span class="citation"></span> and is also a good proxy for many other network properties <span class="citation"></span>. Overall, we found a peak in <em>Salix</em>, gallers and parasitoid diversity in Northern Europe. The expected number of interactions roughly followed the distribution of species richness, but accumulated at a rate different from species numbers. Connectance likewise peaked in Northern Europe (Fig. 5).</p>
<h1 id="interpretation" class="unnumbered">Interpretation</h1>
<p>We have proposed that the representation of community structure and its variation in space is best captured by the formalism of ecological networks, as both the distribution of species and their interspecific interactions can then be accounted for. We consequently revised the niche concept in order to integrate its abiotic and biotic components. This integrated niche was represented visually with an ordination of species into an environmental space and a trait space. The fundamental niche of a species is represented as the set of environmental conditions and resources that allow a species to establish in a location, thereby integrating the Eltonian and the Grinnellian components of the niche. We then translated the concept mathematically by investigating the probability of the joint occurrences of species and their interaction, which should be interpreted as an interaction distribution model. We used this approach to characterize the turnover of the structure of ecological interactions in a species-rich tri-trophic network across Western Europe, finding that the primary driver of network variation is the turnover in species composition.</p>
<p>Applying the framework to our large data set on host-parasite interactions across Europe revealed key features in the interaction between <em>Salix</em> taxa, their herbivores, and the natural enemies of these herbivores. Consistent with a general increase in the diversity of <em>Salix</em> towards boreal areas <span class="citation"></span>, overall species richness of the networks increased towards the north. The distribution of <em>Salix</em> species richness largely matched those of gallers and parasitoids. These observations within Europe are also matched by the ones found at a global scale for <em>Salix</em> <span class="citation"></span> and sawflies <span class="citation"></span>. Species richness in a common group of parasitic wasps, the Ichneumonidae, was originally presumed to show a similar “reversed latitudinal gradient”, but this observation has been recently challenged by findings of rather high ichneumonid diversity in the tropics <span class="citation"></span>. Nevertheless, ichneumonid subfamilies specifically associated with sawflies (Ctenopelmatinae, Tryphoninae) are clearly less diverse in the south.</p>
<p>Exactly what processes are responsible for the distribution of species richness at different trophic levels is yet to be established (but see e.g. <span class="citation"></span>), but as a net outcome of different latitudinal trends across trophic levels, the distribution of co-occurrence and therefore of potential interactions differed between the first and second layers of feeding links. The correlation between expected <em>Salix</em> and galler richness was 0.73, while it was 0.58 between gallers and their parasitoids. Therefore, the ratio of herbivores to <em>Salix</em> species is essentially constant across Europe, whereas each herbivore species is potentially attacked by a richer enemy community higher latitudes. Consequently, overall connectance peaks in Northern Europe (Fig. 5).</p>
<p>In terms of species interacting with each other, our analysis suggests that the environment leaves a detectable imprint on species co-occurrence, but only a slight mark on the occurrence of realized links among species in a specific place: the probability of finding a given combination of species at a higher and a lower trophic level at the same site was clearly affected by the environment, whereas the probability of observing an interaction between the two was, given co-occurrence, not significantly so. The interactions were highly uncertain, as only few pairs of species were systematically interacting when co-occurring but most not. This applies to the example species <em>Phyllocolpa prussica</em> and <em>Chrysocharis elongata</em> (Figs. 3 and 4), but also to all species pairs more generally. For the example species pair, the full model revealed that the joint probability event (interaction and co-occurrence) peaks at intermediate temperature and precipitation, simply because this is where the two species co-occur most often. This does not imply that species will always interact when they meet – although this is a basic assumption in most documented metawebs to date (e.g. <span class="citation"></span>). Rather, an interaction is better represented as a stochastic process whose probability is also influenced by the probability with which species co-occur. What we cannot reliably know is how this stochasticity splits into different sources of uncertainty – i.e., the extent to which a species at the higher trophic level runs into a species at the lower level co-occurring at the site, the extent to which this interaction is detected by an observer collecting a finite sample, or simply the uncertainty arising from incomplete description of a highly dimensional niche. Future work will be required to document the relative importance of these sources of uncertainty in the occurrence of interactions.</p>
<h1 id="perspectives" class="unnumbered">Perspectives</h1>
<p>Evidence that the structure of ecological networks does vary across habitats (e.g. <span class="citation"></span>), over environmental gradients <span class="citation"></span> and in time <span class="citation"></span> is accumulating rapidly. It is not clear, however, to what extent the turnover of network structure is driven by a systematic change in species composition or of pairwise interactions <span class="citation"></span>. Our model comparison of host-parasite interactions revealed that most of the turnover is driven by species-specific responses to the environment, impacting species richness, and that co-occurrence was mostly independent. Further, the occurrence of interactions among host and parasite is highly stochastic even when both are present, and not predictable by the variables considered by us. We know that interactions vary with the environment in other systems, for instance, herbivory <span class="citation"></span> and predation <span class="citation"></span> are often found to increase with temperature, resulting in spatial variation of trophic cascades <span class="citation"></span>. What remains unclear, however, is the extent to which such variation is driven by a turnover of species composition along gradients, or a turnover of the interactions. Here we found that interactions vary substantially but non-predictably along the annual temperature and the precipitation gradient. The lack of detectable signal may be due to our choice of covariates. Indeed, a previous study focusing on a subset of the system studied here identified habitat characteristics as the primary drivers of interactions <span class="citation"></span>. New investigations with other systems will thus be required to challenge this result. Under all circumstances, documenting the relationship between the environment and the occurrence of interactions at continental scales is critical for understanding how large- scale variation of trophic regulation influences community dynamics and ecosystem functioning <span class="citation"></span>.</p>
<p>The framework we provide complements methods to compute network beta-diversity presented by <span class="citation"></span> and <span class="citation"></span>. The total network turnover is partitioned into interaction turnover and species turnover – which in our approach would correspond to the three terms of Eq. 2, respectively. Importantly, one could easily derive the different <span class="math inline"><em>β</em></span> of <span class="citation"></span> using the fitted probabilities. For instance, for a pair of species <span class="math inline"><em>i</em></span> and <span class="math inline"><em>j</em></span> and sites <span class="math inline"><em>x</em></span> and <span class="math inline"><em>y</em></span>, the expectation for the fraction <span class="math inline"><em>a</em></span> for the interactions would be <span class="math inline"><em>P</em>(<em>L</em><sub><em>i</em><em>j</em><em>x</em></sub>|<em>X</em><sub><em>i</em><em>x</em></sub>, <em>X</em><sub><em>i</em><em>j</em><em>x</em></sub>)<em>P</em>(<em>L</em><sub><em>i</em><em>j</em><em>x</em></sub>|<em>X</em><sub><em>i</em><em>x</em></sub>, <em>X</em><sub><em>i</em><em>j</em><em>x</em></sub>)</span>. The same could be computed for fractions <span class="math inline"><em>b</em></span>, and therefore the expected beta-diversity for an entire network could be recomputed this way. The novel feature of the approach presented here is then that the different contributions to network turnover can be attributed to different hypotheses (as performed here), in order to evaluate for instance the role of environmental heterogeneity or species co- distribution on network turnover.</p>
<p>We restricted our analysis to the effect of co-occurrence on ecological interactions, neglecting the inverse of the problem. We did not investigate in depth the drivers of co-occurrence and simply took it for granted from the data. Co-occurrence was indeed different from the expectation of independent species distributions. It thus begs the question of whether, once environmental effects on species-specific distribution have been accounted for, interactions come with significant effects on co-occurrence? We could rephrase this problem by asking whether the fundamental niche differs from the realized niche, and how this applies to our framework. For example, we have considered above simply the co-occurrence probability, <span class="math inline"><em>P</em>(<em>X</em><sub><em>i</em><em>y</em></sub>, <em>X</em><sub><em>j</em><em>y</em></sub>|<em>E</em><sub><em>y</em></sub>)</span>, which could be expanded as <span class="math inline"><em>P</em>(<em>X</em><sub><em>i</em><em>y</em></sub>|<em>X</em><sub><em>j</em><em>y</em></sub>, <em>E</em><sub><em>y</em></sub>)<em>P</em>(<em>X</em><sub><em>j</em><em>y</em></sub>|<em>E</em><sub><em>y</em></sub>)</span>. After some re-arrangement of Eq. 2, the marginal occurrence probability, <span class="math inline"><em>P</em>(<em>X</em><sub><em>j</em><em>y</em></sub>|<em>E</em><sub><em>y</em></sub>)</span>, could be considered as a species distribution model taking into account the interaction between these species (in the same spirit as done by Gonzalez- Salazar et al. 2013). This derivation would however critically depend on a strong <em>a priori</em> expectation of the conditional probability of observing a species given the distribution of the other species. This assumption seems reasonable for some situations, such as a parasitoid species that requires a host to develop. On the other hand, <span class="citation"></span> found that the strength of this association is often rather weak if not inexistant (for instance, with the example pair presented in Table 1). The lack of an association could simply arise when the parasitoid is generalist enough that it is not constrained to track the distribution of any single/given host <span class="citation"></span>.</p>
<p>The approach we presented could easily be expanded to account for traits, in order to derive a complete and more mechanistic representation of the niche. In this context, both the Eltonian and Grinnellian dimensions of the niche could be represented. As mentioned earlier, <span class="citation"></span> proposed to represent the occurrence of interactions based on some trait-matching rules (given by a function of the type <span class="math inline"><em>P</em>(<em>L</em><sub><em>i</em><em>j</em></sub>)|<strong>T</strong><sub><em>i</em></sub>, <strong>T</strong><sub><em>j</em></sub>, <em>E</em>)</span>) and the co-distribution of traits (corresponding to <span class="math inline"><em>P</em>(<strong>T</strong><sub><em>i</em></sub>, <strong>T</strong><sub><em>j</em></sub>|<em>E</em>)</span>). The key insight from the formalism proposed by <span class="citation"></span> is that the co-distribution of traits will impact variation in network structure. As a result, it was found that network properties often co-vary with functional structure and functional diversity <span class="citation"></span>. The next step in the development of this framework will be to develop the models for the co-distribution of traits, for instance following Ovaskainen et al. 2017. This may facilitate the accessibility and the applicability of the framework, since the basic unit of analysis is no longer the species, but rather a combination of traits, thereby facilitating the statistical analysis by sharing information among species.</p>
<p>At present, there is only indirect support for the hypothesis that interacting species are conditionally distributed, but this possibility should be the topic of theoretical investigation with dynamical metacommunity models <span class="citation"></span> and empirical hypothesis testing. The impact of ecological interactions on the distribution of co-occurrence has been the topic of many publications since <span class="citation"></span> seminal study on competition and “checkerboard” distribution, but pairwise approaches have only recently received attention <span class="citation"></span>. Whether two interacting species are more closely associated in space remains unclear, since most approaches based on null models consider community-level metrics (e.g. <span class="citation"></span>), such as the C-score, thereby making it hard to evaluate if specific interactions do indeed affect co-occurrence. The expansion of the framework we describe to account for the difference between the realized and the fundamental niche will therefore require further investigation of the impact of interactions on co-occurrence.</p>
<p>Ecological networks are known to be extremely sparse, <em>i.e.</em> they have far more absences than presences of interactions. Absences of interactions, however, can come from different sources. The fact that unequal sampling at the local scale can affect our understanding of network structure is well documented <span class="citation"></span>. In a spatial context, however, some interactions may be undocumented simply because the species involved have never been observed to co-occur. Although these cases are reported as a lack of interactions, in actuality we cannot make any reliable inference from them: since the species have never been observed together, it remains possible that they would interact if they did. A fundamentally different category of absences of interactions are then those reported after multiple observations of species co-occurence. Thus, to gain confidence that the probability of an interaction is low, extensive sampling (that is, several records of co- occurence) is needed. Generally, our confidence that the interaction is indeed impossible will increase with the number of observations of the species pair. Seeing that this is essentially a Bernoulli process (the probability that the species will interact given their presence), the breadth of the confidence interval is expected to saturate after a fixed number of observations, which can be set as a threshold above which a species pair has finally been observed “often enough”. For instance, if two species are observed together at <span class="math inline"><em>k</em> = 10</span> locations but are never found interacting (<span class="math inline"><em>n</em> = 0</span>), this means that the maximum likelihood estimate for the probability of this binomial distribution is <span class="math inline"><em>p</em> = 0</span>. Using the Clopper-Pearson method to compute the 95% confidence interval, we find that the real value of the probability of the interaction occuring is somewhere between 0 and 0.31. This interval is rather large, indicating that a significant amount of sampling is required to have credible interaction networks. Fortunately, there are Bayesian methods which could be used to complement available information and reduce this uncertainty <span class="citation"></span>.</p>
<h1 id="conclusion" class="unnumbered">Conclusion</h1>
<p>Our representation of spatial variation of community structure offers a new approach for the study of the biogeography of ecological networks. We see the following key challenges and opportunities ahead in this exciting area of research:</p>
<p><strong>1. New generation of network data</strong>. Investigating spatial variation of network structure will require high quality and highly replicated network data. We have investigated one the most comprehensive spatial network datasets we are aware of and nonetheless found immense gaps of knowledge in its resolution. Species richness accumulates much faster than observations of ecological interactions <span class="citation"></span>. Each pair of species must be observed several times in order to obtain reliable estimates of their interaction probability.</p>
<p><strong>2. Estimation of the reliability of interactions</strong>. We need quantitative tools to estimate the confidence intervals around inferred interaction probabilities, as well as estimators of the frequency of false absences. Bayesian methods are promising to that end because we could use information on the target species (e.g. if they are known as specialists or generalists) to provide prior estimates of the interaction probability.</p>
<p><strong>3. From interaction probabilities to a distribution of network properties</strong>. Metrics are available to analyse the structure of probabilistic networks <span class="citation"></span>. These metrics are useful as first approximation, but they assume independence among interactions. This might not be the case in nature because of the role of co-occurrence and shared environmental requirements. We also need to better understand the distribution of network properties arising from probabilistic interactions.</p>
<p><strong>4. Investigation of the environmental-dependence of ecological interactions</strong>. There is evidence that interactions can vary in space, but this problem has not been investigated in a systematic fashion. The paucity of currently available data precludes an extensive analysis of this question at present.</p>
<p><strong>5. Effects of ecological interactions on co-occurrence</strong>. We have intentionally omitted the feedback of ecological interactions on co-occurrence in this framework. As abundance can impact the occurrence of interactions, and, conversely since interactions impact abundance <span class="citation"></span>, we could reasonably expect that interactions will also influence co-occurrence. Theory in this regard does exist for simple three-species modules <span class="citation"></span>, but its extension to entire co-occurrence networks will prove critical in the future, especially given the interest in using co- occurrence to infer ecological interactions <span class="citation"></span>.</p>
<h1 id="acknowledgements" class="unnumbered">Acknowledgements</h1>
<p>This is a contribution to the working groups <em>Continental-scale variation of ecological networks</em> supported by the Canadian Institute for Ecology and Evolution), and the <em>Next Generation Data, Models, and Theory Working Group</em>, supported by the Santa Fe Institute, the Betsy and Jesse Fink Foundation, the ASU-SFI Center for Biosocial Complex Systems, and NSF Grant PHY-1240192. DG also acknowledges financial support from NSERC- Discovery grant program and Canada Research Chair program.</p>
<table>
<caption>Example of data used to perform the analysis. Traditional species distribution models represent the occurrence of single species as a function of the environment, with models such as <span class="math inline"><em>X</em><sub><em>i</em></sub>­ <em>T</em><em>e</em><em>m</em><em>p</em></span> performed one species after the other. Some also tried to represent both the abiotic and biotic niche, with models such as <span class="math inline"><em>X</em><sub><em>i</em></sub>­ <em>T</em><em>e</em><em>m</em><em>p</em> + <em>X</em><sub><em>j</em></sub></span> (e.g. <span class="citation"></span>), while the new joint species distribution models <span class="citation"></span> consider the entire community at once (<span class="math inline"><strong>X</strong> <em>T</em><em>e</em><em>m</em><em>p</em></span>) and aims at representing co-distribution (<span class="math inline"><em>X</em><sub><em>i</em><em>j</em></sub></span>). Here the focus is on the occurrence of interactions, <span class="math inline"><em>L</em><sub><em>i</em><em>j</em></sub></span>. The full model (see model 3, Tables 1 and 2) considers the result of two submodels, one representing the occurrence of interactions given co-occurrence, <span class="math inline"><em>L</em><sub><em>i</em><em>j</em></sub> <em>T</em><em>e</em><em>m</em><em>p</em></span> (evaluated only on the subset of data where <span class="math inline"><em>X</em><sub><em>i</em><em>j</em></sub> = 1</span>), and the other representing the co-occurrence, <span class="math inline"><em>X</em><sub><em>i</em><em>j</em></sub> <em>T</em><em>e</em><em>m</em><em>p</em></span>.</caption>
<thead>
<tr class="header">
<th align="left">Location</th>
<th align="left"><span class="math inline"><em>S</em><em>p</em><sub><em>i</em></sub></span></th>
<th align="left"><span class="math inline"><em>S</em><em>p</em><sub><em>j</em></sub></span></th>
<th align="left"><span class="math inline"><em>X</em><sub><em>i</em></sub></span></th>
<th align="left"><span class="math inline"><em>X</em><sub><em>j</em></sub></span></th>
<th align="left"><span class="math inline"><em>X</em><sub><em>i</em><em>j</em></sub></span></th>
<th align="left"><span class="math inline"><em>L</em><sub><em>i</em><em>j</em></sub></span></th>
<th align="left">Av. temp</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Kühkopf</td>
<td align="left">Phyllocolpa prussica</td>
<td align="left">Chrysocharis elongata</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">8.25</td>
</tr>
<tr class="even">
<td align="left">Kühkopf</td>
<td align="left">Phyllocolpa leucapsis</td>
<td align="left">Chrysocharis elongata</td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">8.25</td>
</tr>
<tr class="odd">
<td align="left">Ötztal</td>
<td align="left">Phyllocolpa prussica</td>
<td align="left">Chrysocharis elongata</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">-1.50</td>
</tr>
<tr class="even">
<td align="left">Ötztal</td>
<td align="left">Phyllocolpa leucapsis</td>
<td align="left">Chrysocharis elongata</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">-1.50</td>
</tr>
<tr class="odd">
<td align="left">Kilpisjärvi</td>
<td align="left">Phyllocolpa prussica</td>
<td align="left">Chrysocharis elongata</td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">-1.92</td>
</tr>
<tr class="even">
<td align="left">Kilpisjärvi</td>
<td align="left">Phyllocolpa leucapsis</td>
<td align="left">Chrysocharis elongata</td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">-1.92</td>
</tr>
<tr class="odd">
<td align="left">Wüstensachsen</td>
<td align="left">Phyllocolpa prussica</td>
<td align="left">Chrysocharis elongata</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">0</td>
<td align="left">5.58</td>
</tr>
<tr class="even">
<td align="left">Wüstensachsen</td>
<td align="left">Phyllocolpa leucapsis</td>
<td align="left">Chrysocharis elongata</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">5.58</td>
</tr>
<tr class="odd">
<td align="left">Steinamoen</td>
<td align="left">Phyllocolpa prussica</td>
<td align="left">Chrysocharis elongata</td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">3.17</td>
</tr>
<tr class="even">
<td align="left">Steinamoen</td>
<td align="left">Phyllocolpa leucapsis</td>
<td align="left">Chrysocharis elongata</td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">3.17</td>
</tr>
</tbody>
</table>
<p>. Note that <span class="math inline"><em>E</em></span> is a short notation including both temperature and precipitation.</p>
<table>
<caption>Summary of model comparison for the interaction between the leaf folder <em>Phyllocolpa prussica</em>) and the parasitoid <em>Chrysocharis elongata</em></caption>
<thead>
<tr class="header">
<th align="left">#</th>
<th align="left">Metaweb model</th>
<th align="left">Co-occurrence model</th>
<th align="left">LL</th>
<th align="left">npars</th>
<th align="left">AIC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="left"><span class="math inline"><em>P</em>(<em>L</em><sub><em>i</em><em>j</em><em>y</em></sub>)</span></td>
<td align="left"><span class="math inline"><em>P</em>(<em>X</em><sub><em>i</em><em>y</em></sub>, <em>X</em><sub><em>j</em><em>y</em></sub>|<em>E</em><sub><em>y</em></sub>)</span></td>
<td align="left">-71.1</td>
<td align="left">6</td>
<td align="left">154.2</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="left"><span class="math inline"><em>P</em>(<em>L</em><sub><em>i</em><em>j</em><em>y</em></sub>|<em>X</em><sub><em>i</em><em>y</em></sub>, <em>X</em><sub><em>j</em><em>y</em></sub>)</span></td>
<td align="left"><span class="math inline"><em>P</em>(<em>X</em><sub><em>i</em><em>y</em></sub>, <em>X</em><sub><em>j</em><em>y</em></sub>|<em>E</em><sub><em>y</em></sub>)</span></td>
<td align="left">-65.7</td>
<td align="left">6</td>
<td align="left">143.4</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="left"><span class="math inline"><em>P</em>(<em>L</em><sub><em>i</em><em>j</em><em>y</em></sub>|<em>X</em><sub><em>i</em><em>y</em></sub>, <em>X</em><sub><em>j</em><em>y</em></sub>, <em>E</em><sub><em>y</em></sub>)</span></td>
<td align="left"><span class="math inline"><em>P</em>(<em>X</em><sub><em>i</em><em>y</em></sub>, <em>X</em><sub><em>j</em><em>y</em></sub>|<em>E</em><sub><em>y</em></sub>)</span></td>
<td align="left">-65.6</td>
<td align="left">10</td>
<td align="left">151.3</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="left"><span class="math inline"><em>P</em>(<em>L</em><sub><em>i</em><em>j</em><em>y</em></sub>|<em>X</em><sub><em>i</em><em>y</em></sub>, <em>X</em><sub><em>j</em><em>y</em></sub>, <em>E</em><sub><em>y</em></sub>)</span></td>
<td align="left"><span class="math inline"><em>P</em>(<em>X</em><sub><em>i</em><em>y</em></sub>, <em>X</em><sub><em>j</em><em>y</em></sub>)</span></td>
<td align="left">-84.5</td>
<td align="left">6</td>
<td align="left">183</td>
</tr>
<tr class="odd">
<td align="left">5</td>
<td align="left"><span class="math inline"><em>P</em>(<em>L</em><sub><em>i</em><em>j</em><em>y</em></sub>|<em>X</em><sub><em>i</em><em>y</em></sub>, <em>X</em><sub><em>j</em><em>y</em></sub>, <em>E</em><sub><em>y</em></sub>)</span></td>
<td align="left"><span class="math inline"><em>P</em>(<em>X</em><sub><em>i</em><em>y</em></sub>)<em>P</em>(<em>X</em><sub><em>j</em><em>y</em></sub>)</span></td>
<td align="left">-80.7</td>
<td align="left">7</td>
<td align="left">173.4</td>
</tr>
<tr class="even">
<td align="left">6</td>
<td align="left"><span class="math inline"><em>P</em>(<em>L</em><sub><em>i</em><em>j</em><em>y</em></sub>|<em>X</em><sub><em>i</em><em>y</em></sub>, <em>X</em><sub><em>j</em><em>y</em></sub>, <em>E</em><sub><em>y</em></sub>)</span></td>
<td align="left"><span class="math inline"><em>P</em>(<em>X</em><sub><em>i</em><em>y</em></sub>|<em>E</em><sub><em>y</em></sub>)<em>P</em>(<em>X</em><sub><em>j</em><em>y</em></sub>|<em>E</em><sub><em>y</em></sub>)</span></td>
<td align="left">-68.8</td>
<td align="left">15</td>
<td align="left">167.6</td>
</tr>
</tbody>
</table>
<table>
<caption>Summary of model comparison for the interaction across all pairs of <em>Salix</em>, gallers and parasitoids.</caption>
<thead>
<tr class="header">
<th align="left">Interaction</th>
<th align="left">#</th>
<th align="left">Metaweb model</th>
<th align="left">Co-occurrence model</th>
<th align="left">LL</th>
<th align="left">npars</th>
<th align="left">AIC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><em>Salix</em>-Galler</td>
<td align="left">1</td>
<td align="left"><span class="math inline"><em>P</em>(<em>L</em><sub><em>i</em><em>j</em><em>y</em></sub>)</span></td>
<td align="left"><span class="math inline"><em>P</em>(<em>X</em><sub><em>i</em><em>y</em></sub>, <em>X</em><sub><em>j</em><em>y</em></sub>|<em>E</em><sub><em>y</em></sub>)</span></td>
<td align="left">-6022.1</td>
<td align="left">7548</td>
<td align="left">27140.3</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">2</td>
<td align="left"><span class="math inline"><em>P</em>(<em>L</em><sub><em>i</em><em>j</em><em>y</em></sub>|<em>X</em><sub><em>i</em><em>y</em></sub>, <em>X</em><sub><em>j</em><em>y</em></sub>)</span></td>
<td align="left"><span class="math inline"><em>P</em>(<em>X</em><sub><em>i</em><em>y</em></sub>, <em>X</em><sub><em>j</em><em>y</em></sub>|<em>E</em><sub><em>y</em></sub>)</span></td>
<td align="left">-5547.9</td>
<td align="left">7548</td>
<td align="left">26191.8</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">3</td>
<td align="left"><span class="math inline"><em>P</em>(<em>L</em><sub><em>i</em><em>j</em><em>y</em></sub>|<em>X</em><sub><em>i</em><em>y</em></sub>, <em>X</em><sub><em>j</em><em>y</em></sub>, <em>E</em><sub><em>y</em></sub>)</span></td>
<td align="left"><span class="math inline"><em>P</em>(<em>X</em><sub><em>i</em><em>y</em></sub>, <em>X</em><sub><em>j</em><em>y</em></sub>|<em>E</em><sub><em>y</em></sub>)</span></td>
<td align="left">-5364.0</td>
<td align="left">12580</td>
<td align="left">35888.0</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">4</td>
<td align="left"><span class="math inline"><em>P</em>(<em>L</em><sub><em>i</em><em>j</em><em>y</em></sub>|<em>X</em><sub><em>i</em><em>y</em></sub>, <em>X</em><sub><em>j</em><em>y</em></sub>, <em>E</em><sub><em>y</em></sub>)</span></td>
<td align="left"><span class="math inline"><em>P</em>(<em>X</em><sub><em>i</em><em>y</em></sub>, <em>X</em><sub><em>j</em><em>y</em></sub>)</span></td>
<td align="left">-5998.4</td>
<td align="left">8806</td>
<td align="left">30287.2</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">5</td>
<td align="left"><span class="math inline"><em>P</em>(<em>L</em><sub><em>i</em><em>j</em><em>y</em></sub>|<em>X</em><sub><em>i</em><em>y</em></sub>, <em>X</em><sub><em>j</em><em>y</em></sub>, <em>E</em><sub><em>y</em></sub>)</span></td>
<td align="left"><span class="math inline"><em>P</em>(<em>X</em><sub><em>i</em><em>y</em></sub>)<em>P</em>(<em>X</em><sub><em>j</em><em>y</em></sub>)</span></td>
<td align="left">-6636.1</td>
<td align="left">7548</td>
<td align="left">27092.7</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">6</td>
<td align="left"><span class="math inline"><em>P</em>(<em>L</em><sub><em>i</em><em>j</em><em>y</em></sub>|<em>X</em><sub><em>i</em><em>y</em></sub>, <em>X</em><sub><em>j</em><em>y</em></sub>, <em>E</em><sub><em>y</em></sub>)</span></td>
<td align="left"><span class="math inline"><em>P</em>(<em>X</em><sub><em>i</em><em>y</em></sub>|<em>E</em><sub><em>y</em></sub>)<em>P</em>(<em>X</em><sub><em>j</em><em>y</em></sub>|<em>E</em><sub><em>y</em></sub>)</span></td>
<td align="left">-6002.9</td>
<td align="left">18870</td>
<td align="left">49745.7</td>
</tr>
<tr class="odd">
<td align="left">Galler-Parasitoid</td>
<td align="left">1</td>
<td align="left"><span class="math inline"><em>P</em>(<em>L</em><sub><em>i</em><em>j</em><em>y</em></sub>)</span></td>
<td align="left"><span class="math inline"><em>P</em>(<em>X</em><sub><em>i</em><em>y</em></sub>, <em>X</em><sub><em>j</em><em>y</em></sub>|<em>E</em><sub><em>y</em></sub>)</span></td>
<td align="left">-22068.1</td>
<td align="left">19206</td>
<td align="left">82548.2</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">2</td>
<td align="left"><span class="math inline"><em>P</em>(<em>L</em><sub><em>i</em><em>j</em><em>y</em></sub>|<em>X</em><sub><em>i</em><em>y</em></sub>, <em>X</em><sub><em>j</em><em>y</em></sub>)</span></td>
<td align="left"><span class="math inline"><em>P</em>(<em>X</em><sub><em>i</em><em>y</em></sub>, <em>X</em><sub><em>j</em><em>y</em></sub>|<em>E</em><sub><em>y</em></sub>)</span></td>
<td align="left">-19504.8</td>
<td align="left">19206</td>
<td align="left">77421.6</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">3</td>
<td align="left"><span class="math inline"><em>P</em>(<em>L</em><sub><em>i</em><em>j</em><em>y</em></sub>|<em>X</em><sub><em>i</em><em>y</em></sub>, <em>X</em><sub><em>j</em><em>y</em></sub>, <em>E</em><sub><em>y</em></sub>)</span></td>
<td align="left"><span class="math inline"><em>P</em>(<em>X</em><sub><em>i</em><em>y</em></sub>, <em>X</em><sub><em>j</em><em>y</em></sub>|<em>E</em><sub><em>y</em></sub>)</span></td>
<td align="left">-20217.0</td>
<td align="left">32010</td>
<td align="left">104454.1</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">4</td>
<td align="left"><span class="math inline"><em>P</em>(<em>L</em><sub><em>i</em><em>j</em><em>y</em></sub>|<em>X</em><sub><em>i</em><em>y</em></sub>, <em>X</em><sub><em>j</em><em>y</em></sub>, <em>E</em><sub><em>y</em></sub>)</span></td>
<td align="left"><span class="math inline"><em>P</em>(<em>X</em><sub><em>i</em><em>y</em></sub>, <em>X</em><sub><em>j</em><em>y</em></sub>)</span></td>
<td align="left">-19591.3</td>
<td align="left">22407</td>
<td align="left">77594.5</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">5</td>
<td align="left"><span class="math inline"><em>P</em>(<em>L</em><sub><em>i</em><em>j</em><em>y</em></sub>|<em>X</em><sub><em>i</em><em>y</em></sub>, <em>X</em><sub><em>j</em><em>y</em></sub>, <em>E</em><sub><em>y</em></sub>)</span></td>
<td align="left"><span class="math inline"><em>P</em>(<em>X</em><sub><em>i</em><em>y</em></sub>)<em>P</em>(<em>X</em><sub><em>j</em><em>y</em></sub>)</span></td>
<td align="left">-22491.5</td>
<td align="left">19206</td>
<td align="left">89796.9</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">6</td>
<td align="left"><span class="math inline"><em>P</em>(<em>L</em><sub><em>i</em><em>j</em><em>y</em></sub>|<em>X</em><sub><em>i</em><em>y</em></sub>, <em>X</em><sub><em>j</em><em>y</em></sub>, <em>E</em><sub><em>y</em></sub>)</span></td>
<td align="left"><span class="math inline"><em>P</em>(<em>X</em><sub><em>i</em><em>y</em></sub>|<em>E</em><sub><em>y</em></sub>)<em>P</em>(<em>X</em><sub><em>j</em><em>y</em></sub>|<em>E</em><sub><em>y</em></sub>)</span></td>
<td align="left">-18936.9</td>
<td align="left">48015</td>
<td align="left">133903.7</td>
</tr>
</tbody>
</table>
<h1 id="figure-legends" class="unnumbered">Figure legends</h1>
<h2 id="figure-1" class="unnumbered">Figure 1</h2>
<p><strong>Non-random sampling of the metaweb</strong>. Network assembly can be viewed as a sampling process of the regional pool of potential interactions. Species (indicated by colored nodes) are sampled first, and among the species found in the local network, only some interactions (indicated by blue links) occur. We characterize these sampling processes with the quantitative framework proposed in this paper. As a concrete illustration of metaweb sampling, we here show a local interaction network among <em>Salix</em> (bottom/green), gallers (center/blue), and parasitoids (top/red). The metaweb was constructed by aggregating interactions observed across 370 local networks. Nodes were distributed to minimize crossing of interactions.</p>
<h2 id="figure-2" class="unnumbered">Figure 2</h2>
<p><strong>Visual representation of the integrated niche</strong>. In biogeography, the niche is considered the set of environmental conditions where the intrinsic growth rate <span class="math inline"><em>r</em></span> is positive <span class="citation"></span>. The horizontal axis represents an environmental gradient impacting the growth of a focal species (red point). The location of each species (grey points) along this gradient represents their optimum, and the vertical dotted lines represent the limits of the Grinnellian niche of the focal species. In food web ecology, the Eltonian niche represents the location of a species in the food web, as determined by its niche position (<span class="math inline"><em>n</em></span>) and its niche optimum (<span class="math inline"><em>c</em></span>). The vertical axis represents a niche gradient, for example a trait such as body size. The location of each species along this gradient represents their niche position. The focal species will feed only on host/prey species occupying niche locations within a given interval around the optimum, represented by the horizontal lines. The integrated Grinnellian and Eltonian niche corresponds to the square in the middle where an interaction is possible owing to a match of traits and spatial distribution. The central square represents the area where the joint probability of observing co-occurrence and interactions is positive.</p>
<h2 id="figure-3" class="unnumbered">Figure 3</h2>
<p><strong>Probabilistic representation of the interaction probability between a leaf folder (<em>Phyllocolpa prussica</em>) and a parasitoid (<em>Chrysocharis elongata</em>) across gradients of annual average temperature and annual precipitation</strong>. The colour gradient represents the probability of observing the event, from 0 (white) to 1 (black). The representation is based on predictions from Model 3 (see Table 1). In the left panel, open circles represent the absence of both species, whereas closed circles represent co- occurrence and plus signs the occurrence of only one of the two species. In the other two panels, open circles represent co-occurrence but an absence of interaction and closed circles the occurrence of an interaction.</p>
<h2 id="figure-4" class="unnumbered">Figure 4</h2>
<p><strong>Probabilistic representation of the interaction probability between a leaf folder (<em>Phyllocolpa prussica</em>) and a parasitoid (<em>Chrysocharis elongata</em>) across Europe</strong>. Climate data are extracted from WorldClim over a 1km x 1km grid and predictions made according to the model illustrated at Fig. 3. Colour gradient ranges from low values (dark blue) to high values (yellow).</p>
<h2 id="figure-5" class="unnumbered">Figure 5</h2>
<p><strong>Mapping the distribution of species richness, the number of links and connectance across Europe</strong>. The representation is based on predictions from Model 3 (see Table 2) using climate data extracted from WorldClim over a 1km x 1km grid. Species richness is obtained by summation of individual occurrence probabilities, and link density by summation of interaction probabilities. Color gradient ranges from low values (dark blue) to high values (yellow).</p>
<h2 id="figure-1-1" class="unnumbered">Figure 1</h2>
<p><img src="figures/mw_sampling" alt="image" style="width:100.0%" /></p>
<h2 id="figure-2-1" class="unnumbered">Figure 2</h2>
<p><img src="figures/integrated_niche" alt="image" style="width:60.0%" /></p>
<h2 id="figure-3-1" class="unnumbered">Figure 3</h2>
<p><img src="figures/example_pair" alt="image" style="width:80.0%" /></p>
<h2 id="figure-4-1" class="unnumbered">Figure 4</h2>
<p><img src="figures/map_pair" alt="image" style="width:80.0%" /></p>
<h2 id="figure-5-1" class="unnumbered">Figure 5</h2>
<p><img src="figures/map_connectance" alt="image" style="width:80.0%" /></p>
